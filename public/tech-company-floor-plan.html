<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì¢Œì„ ë°°ì¹˜ë„ - 2025 ë””ìì¸-ê¸°ìˆ  í˜‘ì—… ì „ì£¼ê¸°ì§€ì›</title>
  <style>
    * {margin: 0; padding: 0; box-sizing: border-box;}
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Noto Sans KR, sans-serif;
      margin: 0;
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
      color: #ffffff;
      min-height: 100vh;
      padding: 20px;
    }
    
    .container {
      max-width: 1400px;
      margin: 0 auto;
    }
    
    .header {
      text-align: center;
      margin-bottom: 40px;
      animation: fadeInDown 0.8s ease-out;
    }
    
    .logo {
      width: 70px;
      height: 70px;
      margin: 0 auto 20px;
      background: linear-gradient(135deg, #DC2626, #EF4444);
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 20px 60px rgba(220, 38, 38, 0.4);
      animation: pulse 2s ease-in-out infinite;
    }
    
    .logo-icon {
      font-size: 36px;
    }
    
    h1 {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #DC2626, #ffffff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .subtitle {
      font-size: 16px;
      color: #a0a0a0;
      font-weight: 400;
    }
    
    /* ì¢Œì„ ê²€ìƒ‰ ì„¹ì…˜ */
    .seat-finder {
      background: #1a1a1a;
      border: 1px solid #2a2a2a;
      border-radius: 16px;
      padding: 30px;
      margin-bottom: 30px;
      animation: fadeInUp 0.8s ease-out 0.1s both;
    }
    
    .seat-finder-title {
      font-size: 24px;
      font-weight: 700;
      color: #ffffff;
      margin-bottom: 20px;
      text-align: center;
    }
    
    .search-input-container {
      position: relative;
      max-width: 600px;
      margin: 0 auto 10px;
    }
    
    .search-input {
      width: 100%;
      padding: 16px 20px;
      background: #1a1a1a;
      border: 2px solid #2a2a2a;
      border-radius: 12px;
      color: #ffffff;
      font-size: 16px;
      transition: all 0.3s ease;
    }
    
    .search-input:focus {
      outline: none;
      border-color: #DC2626;
      box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
    }
    
    .search-hint {
      text-align: center;
      font-size: 13px;
      color: #a0a0a0;
      margin-bottom: 20px;
    }
    
    .loading-indicator {
      text-align: center;
      padding: 20px;
      color: #a0a0a0;
      font-size: 14px;
      display: none;
    }
    
    .loading-indicator.show {
      display: block;
    }
    
    .loading-spinner {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(220, 38, 38, 0.3);
      border-top-color: #DC2626;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
      margin-right: 10px;
      vertical-align: middle;
    }
    
    @keyframes spin {
      to { transform: rotate(360deg); }
    }
    
    .search-results-header {
      text-align: center;
      font-size: 13px;
      color: #a0a0a0;
      margin-bottom: 10px;
      display: none;
    }
    
    .search-results-header.show {
      display: block;
    }
    
    .search-results {
      max-width: 600px;
      margin: 0 auto 20px;
      max-height: 200px;
      overflow-y: auto;
    }
    
    .search-result-item {
      padding: 12px 16px;
      background: #1a1a1a;
      border: 2px solid #2a2a2a;
      border-radius: 8px;
      margin-bottom: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .search-result-item:hover {
      background: #2a2a2a;
      border-color: #DC2626;
      transform: translateX(5px);
    }
    
    .search-result-name {
      font-size: 15px;
      color: #ffffff;
      font-weight: 600;
    }
    
    .seat-info-display {
      max-width: 800px;
      margin: 30px auto 0;
      padding: 25px;
      background: #1a1a1a;
      border: 2px solid #DC2626;
      border-radius: 16px;
      text-align: center;
      display: none;
      animation: fadeIn 0.3s ease-out;
    }
    
    .seat-info-display.show {
      display: block;
    }
    
    .seat-info-text {
      font-size: 20px;
      line-height: 1.8;
      color: #ffffff;
      font-weight: 500;
    }
    
    .seat-info-name {
      color: #DC2626;
      font-weight: 700;
      font-size: 22px;
    }
    
    .seat-info-location {
      color: #DC2626;
      font-weight: 700;
    }
    
    .session-card {
      background: #1a1a1a;
      border: 2px solid #DC2626;
      border-radius: 12px;
      padding: 15px;
      margin-top: 15px;
    }
    
    .session-header {
      font-size: 16px;
      font-weight: 700;
      color: #DC2626;
      margin-bottom: 8px;
    }
    
    .session-time {
      font-size: 15px;
      color: #DC2626;
      font-weight: 600;
      margin-left: 8px;
    }
    
    .session-row {
      font-size: 14px;
      color: #ffffff;
      margin-top: 8px;
      line-height: 1.6;
    }
    
    .session-label {
      color: #a0a0a0;
      font-size: 13px;
      display: inline-block;
      width: 70px;
    }
    
    .session-value {
      color: #ffffff;
      font-weight: 500;
    }
    
    .floor-plan-container {
      background: #1a1a1a;
      border: 1px solid #2a2a2a;
      border-radius: 16px;
      padding: 20px;
      margin-bottom: 30px;
      animation: fadeInUp 0.8s ease-out 0.2s both;
      overflow: hidden;
    }
    
    .floor-plan-image {
      width: 100%;
      height: auto;
      display: block;
      border-radius: 12px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    }
    
    .navigation {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-top: 30px;
      animation: fadeIn 0.8s ease-out 0.4s both;
    }
    
    .nav-button {
      display: inline-block;
      padding: 16px 40px;
      background: #1a1a1a;
      border: 2px solid #2a2a2a;
      color: #ffffff;
      text-decoration: none;
      border-radius: 16px;
      font-size: 16px;
      font-weight: 600;
      transition: all 0.3s ease;
    }
    
    .nav-button:hover {
      transform: translateY(-3px);
      background: #2a2a2a;
      border-color: #DC2626;
      color: #ffffff;
    }
    
    .nav-button:active {
      transform: translateY(-1px);
    }
    
    .nav-button.primary {
      background: #DC2626;
      color: #FFFFFF;
      border-color: #DC2626;
    }
    
    .nav-button.primary:hover {
      background: #B91C1C;
      border-color: #B91C1C;
    }
    
    .footer {
      text-align: center;
      margin-top: 60px;
      padding-top: 30px;
      border-top: 1px solid #2a2a2a;
      animation: fadeIn 0.8s ease-out 0.6s both;
    }
    
    .footer-text {
      font-size: 14px;
      color: #a0a0a0;
      margin-bottom: 8px;
    }
    
    .footer-org {
      font-size: 13px;
      color: #a0a0a0;
      margin-bottom: 8px;
    }
    
    .footer-logo {
      font-size: 12px;
      color: #707070;
    }
    
    /* ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ */
    .search-results::-webkit-scrollbar {
      width: 8px;
    }
    
    .search-results::-webkit-scrollbar-track {
      background: #1a1a1a;
      border-radius: 4px;
    }
    
    .search-results::-webkit-scrollbar-thumb {
      background: #DC2626;
      border-radius: 4px;
    }
    
    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }
    
    @keyframes pulse {
      0%, 100% {
        box-shadow: 0 20px 60px rgba(220, 38, 38, 0.4);
      }
      50% {
        box-shadow: 0 20px 80px rgba(220, 38, 38, 0.6);
      }
    }
    
    @media (max-width: 768px) {
      body {
        padding: 15px;
      }
      
      .header {
        margin-bottom: 30px;
      }
      
      .logo {
        width: 60px;
        height: 60px;
        margin-bottom: 15px;
      }
      
      .logo-icon {
        font-size: 30px;
      }
      
      h1 {
        font-size: 26px;
      }
      
      .subtitle {
        font-size: 15px;
      }
      
      .seat-finder {
        padding: 24px;
        margin-bottom: 24px;
      }
      
      .seat-finder-title {
        font-size: 22px;
        margin-bottom: 18px;
      }
      
      .search-input {
        padding: 14px 18px;
        font-size: 15px;
        border-width: 2px;
      }
      
      .seat-info-text {
        font-size: 15px;
      }
      
      .seat-info-name {
        font-size: 19px;
      }
      
      .floor-plan-container {
        padding: 20px;
      }
      
      .navigation {
        flex-direction: column;
        gap: 12px;
      }
      
      .nav-button {
        font-size: 14px;
        padding: 12px 24px;
      }
    }
    
    @media (max-width: 600px) {
      body {
        padding: 12px;
      }
      
      h1 {
        font-size: 24px;
      }
      
      .subtitle {
        font-size: 14px;
      }
      
      .seat-finder {
        padding: 20px;
      }
      
      .seat-finder-title {
        font-size: 20px;
      }
      
      .seat-info-text {
        font-size: 14px;
      }
      
      .seat-info-name {
        font-size: 18px;
      }
      
      .floor-plan-container {
        padding: 15px;
      }
      
      .navigation {
        gap: 10px;
      }
      
      .nav-button {
        font-size: 13px;
        padding: 12px 20px;
      }
    }
    
    @media (max-width: 480px) {
      body {
        padding: 10px;
      }
      
      .logo {
        width: 50px;
        height: 50px;
        margin-bottom: 12px;
      }
      
      .logo-icon {
        font-size: 24px;
      }
      
      h1 {
        font-size: 20px;
      }
      
      .subtitle {
        font-size: 13px;
      }
      
      .seat-finder {
        padding: 16px;
        border-width: 2px;
      }
      
      .seat-finder-title {
        font-size: 18px;
        margin-bottom: 15px;
      }
      
      .search-input {
        padding: 12px 16px;
        font-size: 14px;
      }
      
      .seat-info-text {
        font-size: 13px;
      }
      
      .seat-info-name {
        font-size: 16px;
      }
      
      .floor-plan-container {
        padding: 12px;
      }
      
      .nav-button {
        font-size: 12px;
        padding: 10px 18px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="logo">
        <span class="logo-icon">ğŸ“</span>
      </div>
      <h1>ì¢Œì„ ë°°ì¹˜ë„</h1>
      <p class="subtitle">2025 ë””ìì¸-ê¸°ìˆ  í˜‘ì—… ì „ì£¼ê¸°ì§€ì›</p>
    </div>
    
    <!-- ì¢Œì„ ê²€ìƒ‰ ì„¹ì…˜ -->
    <div class="seat-finder">
      <h2 class="seat-finder-title">ğŸª‘ ì € ì–´ë”” ì•‰ì•„ìš”?</h2>
      
      <div class="search-input-container">
        <input 
          type="text" 
          id="seatSearch" 
          class="search-input" 
          placeholder="ì´ë¦„ ë˜ëŠ” íšŒì‚¬ëª… ì…ë ¥..."
          autocomplete="off"
          autocapitalize="none"
          autocorrect="off"
          spellcheck="false"
        />
      </div>
      
      <p class="search-hint">íšŒì‚¬ëª…ì´ë‚˜ ì´ë¦„ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”</p>
      
      <div id="loadingIndicator" class="loading-indicator">
        <span class="loading-spinner"></span>
        ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
      </div>
      
      <div id="searchResultsHeader" class="search-results-header"></div>
      <div id="searchResults" class="search-results"></div>
      
      <div id="seatInfo" class="seat-info-display">
        <p class="seat-info-text" id="seatInfoText">
          <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
        </p>
      </div>
      
      <!-- ë¼ìš´ë“œë³„ ë°°ì • ì •ë³´ í‘œì‹œ -->
      <div id="roundAssignments" style="margin-top: 30px; display: none;">
        <h3 style="color: #DC2626; margin-bottom: 20px; text-align: center; font-size: 20px;">ğŸ“… ë¼ìš´ë“œë³„ ë°°ì • í˜„í™©</h3>
        <div id="roundAssignmentsContent"></div>
      </div>
    </div>
    
    <div class="navigation">
      <a href="javascript:history.back()" class="nav-button">
        â† ë’¤ë¡œ ê°€ê¸°
      </a>
      <a href="index.html" class="nav-button primary">
        í™ˆìœ¼ë¡œ ëŒì•„ê°€ê¸°
      </a>
    </div>
    
    <div class="footer">
      <p class="footer-text">2025 ë””ìì¸-ê¸°ìˆ  í˜‘ì—… ì „ì£¼ê¸°ì§€ì›</p>
      <p class="footer-org">ì£¼ìµœ: ì‚°ì—…í†µìƒë¶€, ì£¼ê´€: í•œêµ­ë””ìì¸ì§„í¥ì›, ìš´ì˜: MYSC</p>
      <p class="footer-logo">Powered by EpicStage</p>
    </div>
  </div>
  
  <script>
    const CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTdxkwUoTKh5y5xLeMwerXez9IpL6_QEY09ipRULpS-R60XiiSVMWC3LEjgVzHU57_EjlIVvg1LfSw_/pub?output=csv';
    
    let techCompanyData = [];
    
    // CSV íŒŒì‹± í•¨ìˆ˜ (RFC 4180 í‘œì¤€)
    function parseCSV(text) {
      const rows = [];
      let currentRow = '';
      let insideQuotes = false;
      
      for (let i = 0; i < text.length; i++) {
        const char = text[i];
        const nextChar = text[i + 1];
        
        if (char === '"') {
          currentRow += '"';
          if (insideQuotes && nextChar === '"') {
            currentRow += '"';
            i++;
          } else {
            insideQuotes = !insideQuotes;
          }
        } else if (char === '\n' && !insideQuotes) {
          if (currentRow.trim()) {
            rows.push(currentRow);
          }
          currentRow = '';
        } else {
          currentRow += char;
        }
      }
      
      if (currentRow.trim()) {
        rows.push(currentRow);
      }
      
      return rows;
    }
    
    // CSV í–‰ì„ í•„ë“œë¡œ ë¶„ë¦¬
    function splitLine(line) {
      const fields = [];
      let currentField = '';
      let insideQuotes = false;
      
      for (let i = 0; i < line.length; i++) {
        const char = line[i];
        const nextChar = line[i + 1];
        
        if (char === '"') {
          if (insideQuotes && nextChar === '"') {
            currentField += '"';
            i++;
          } else {
            insideQuotes = !insideQuotes;
          }
        } else if (char === ',' && !insideQuotes) {
          fields.push(currentField.trim());
          currentField = '';
        } else {
          currentField += char;
        }
      }
      
      fields.push(currentField.trim());
      return fields;
    }
    
    // ë¼ìš´ë“œ ë°°ì • ë°ì´í„° ë¡œë“œ
    async function loadAssignmentData() {
      try {
        const response = await fetch('/api/kidp2025/meetup/assignments');
        if (response.ok) {
          const data = await response.json();
          if (data.success && data.assignments) {
            assignmentData = data;
            displayRoundAssignments();
          }
        }
      } catch (error) {
        console.warn('ë¼ìš´ë“œ ë°°ì • ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', error);
      }
    }
    
    // ë¼ìš´ë“œë³„ ë°°ì • ì •ë³´ í‘œì‹œ
    function displayRoundAssignments() {
      if (!assignmentData || !assignmentData.assignments || assignmentData.assignments.length === 0) {
        return;
      }
      
      const container = document.getElementById('roundAssignments');
      const content = document.getElementById('roundAssignmentsContent');
      
      // ë¼ìš´ë“œë³„ë¡œ ê·¸ë£¹í™”
      const rounds = {};
      for (const assignment of assignmentData.assignments) {
        if (!rounds[assignment.round]) {
          rounds[assignment.round] = [];
        }
        rounds[assignment.round].push(assignment);
      }
      
      let html = '';
      for (const roundNum of Object.keys(rounds).sort((a, b) => parseInt(a) - parseInt(b))) {
        const roundAssignments = rounds[roundNum];
        html += `
          <div style="margin-bottom: 25px; padding: 20px; background: #2a2a2a; border-radius: 12px; border-left: 4px solid #DC2626;">
            <h4 style="color: #DC2626; margin-bottom: 15px; font-size: 18px;">ë¼ìš´ë“œ ${roundNum}</h4>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 10px;">
        `;
        
        for (const assignment of roundAssignments.sort((a, b) => a.table - b.table)) {
          html += `
            <div style="padding: 12px; background: #1a1a1a; border-radius: 8px; border: 1px solid #3a3a3a;">
              <div style="color: #DC2626; font-weight: 600; margin-bottom: 8px;">í…Œì´ë¸” ${assignment.table}</div>
              <div style="font-size: 14px; color: #ffffff; margin-bottom: 4px;">${escapeHtml(assignment.techCompany)}</div>
              <div style="font-size: 14px; color: #ffffff;">${escapeHtml(assignment.designCompany)}</div>
              <div style="font-size: 12px; color: #a0a0a0; margin-top: 6px;">ë§¤ì¹­ ì ìˆ˜: ${assignment.score}ì </div>
            </div>
          `;
        }
        
        html += `
            </div>
          </div>
        `;
      }
      
      content.innerHTML = html;
      container.style.display = 'block';
    }
    
    // HTML ì´ìŠ¤ì¼€ì´í”„ í•¨ìˆ˜
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
    
    // ê¸°ìˆ ê¸°ì—… ë°ì´í„° ë¡œë“œ
    async function loadSeatData() {
      const loadingIndicator = document.getElementById('loadingIndicator');
      loadingIndicator.classList.add('show');
      
      try {
        // ë¼ìš´ë“œ ë°°ì • ë°ì´í„° ë¨¼ì € ë¡œë“œ
        await loadAssignmentData();
        
        // CSV ë°ì´í„° ë¡œë“œ
        const response = await fetch(TECH_CSV_URL);
        
        if (!response.ok) {
          throw new Error(`ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. (ìƒíƒœ ì½”ë“œ: ${response.status})`);
        }
        
        const text = await response.text();
        const rows = parseCSV(text);
        
        if (rows.length < 2) {
          throw new Error('CSV íŒŒì¼ì— ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ë°ì´í„°ê°€ ì…ë ¥ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.');
        }
        
        const headers = splitLine(rows[0]);
        const nameIndex = headers.findIndex(h => h === 'ê¸°ì—…ëª…' || h === 'ë©˜í† ëª…' || h === 'ê¸°ìˆ ê¸°ì—…ëª…');
        const fixedSeatIndex = headers.findIndex(h => h === 'ì§€ì •ì„');
        const session1Index = headers.findIndex(h => h === '1ì„¸ì…˜');
        const designCompany1Index = headers.findIndex(h => h === '1_ìŠ¤íƒ€íŠ¸ì—…' || h === '1_ë””ìì¸ì „ë¬¸ê¸°ì—…');
        const session2Index = headers.findIndex(h => h === '2ì„¸ì…˜');
        const designCompany2Index = headers.findIndex(h => h === '2_ìŠ¤íƒ€íŠ¸ì—…' || h === '2_ë””ìì¸ì „ë¬¸ê¸°ì—…');
        const session3Index = headers.findIndex(h => h === '3ì„¸ì…˜');
        const designCompany3Index = headers.findIndex(h => h === '3_ìŠ¤íƒ€íŠ¸ì—…' || h === '3_ë””ìì¸ì „ë¬¸ê¸°ì—…');
        const session4Index = headers.findIndex(h => h === '4ì„¸ì…˜');
        const designCompany4Index = headers.findIndex(h => h === '4_ìŠ¤íƒ€íŠ¸ì—…' || h === '4_ë””ìì¸ì „ë¬¸ê¸°ì—…');
        
        if (nameIndex === -1) {
          throw new Error('CSV íŒŒì¼ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤. "ê¸°ì—…ëª…", "ê¸°ìˆ ê¸°ì—…ëª…" ë˜ëŠ” "ë©˜í† ëª…" ì»¬ëŸ¼ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        }
        
        techCompanyData = [];
        for (let i = 1; i < rows.length; i++) {
          const cells = splitLine(rows[i]);
          if (cells[nameIndex] && cells[nameIndex].trim()) {
            techCompanyData.push({
              name: cells[nameIndex].trim(),
              fixedSeat: cells[fixedSeatIndex]?.trim() || 'ë¯¸ì •',
              session1: cells[session1Index]?.trim() || '',
              designCompany1: cells[designCompany1Index]?.trim() || 'ë¯¸ì •',
              session2: cells[session2Index]?.trim() || '',
              designCompany2: cells[designCompany2Index]?.trim() || 'ë¯¸ì •',
              session3: cells[session3Index]?.trim() || '',
              designCompany3: cells[designCompany3Index]?.trim() || 'ë¯¸ì •',
              session4: cells[session4Index]?.trim() || '',
              designCompany4: cells[designCompany4Index]?.trim() || 'ë¯¸ì •'
            });
          }
        }
        
        if (techCompanyData.length === 0) {
          throw new Error('ë¡œë“œëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ê´€ë¦¬ì í˜ì´ì§€ì—ì„œ ê¸°ìˆ ê¸°ì—… ì •ë³´ê°€ ì…ë ¥ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.');
        }
        
        console.log('ê¸°ìˆ ê¸°ì—… ì¢Œì„ ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', techCompanyData.length, 'ê°œ');
        
        // ë””ìì¸ê¸°ì—… ë°ì´í„°ë„ ë¡œë“œ
        try {
          const designResponse = await fetch(DESIGN_CSV_URL);
          if (designResponse.ok) {
            const designText = await designResponse.text();
            const designRows = parseCSV(designText);
            
            if (designRows.length >= 2) {
              const designHeaders = splitLine(designRows[0]);
              const designNameIndex = designHeaders.findIndex(h => h === 'ê¸°ì—…ëª…' || h === 'ë©˜í† ëª…' || h === 'ë””ìì¸ì „ë¬¸ê¸°ì—…');
              
              if (designNameIndex !== -1) {
                designCompanyData = [];
                for (let i = 1; i < designRows.length; i++) {
                  const cells = splitLine(designRows[i]);
                  if (cells[designNameIndex] && cells[designNameIndex].trim()) {
                    designCompanyData.push({
                      name: cells[designNameIndex].trim()
                    });
                  }
                }
                console.log('ë””ìì¸ê¸°ì—… ë°ì´í„° ë¡œë“œ ì™„ë£Œ:', designCompanyData.length, 'ê°œ');
              }
            }
          }
        } catch (error) {
          console.warn('ë””ìì¸ê¸°ì—… ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
        }
        
        loadingIndicator.classList.remove('show');
      } catch (error) {
        console.error('CSV ë¡œë“œ ì˜¤ë¥˜:', error);
        loadingIndicator.classList.add('show');
        loadingIndicator.innerHTML = `
          <div style="color: #DC2626; line-height: 1.6;">
            <div style="font-size: 16px; font-weight: 600; margin-bottom: 8px;">âš ï¸ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨</div>
            <div style="font-size: 14px;">${error.message}</div>
            <div style="font-size: 13px; color: #a0a0a0; margin-top: 12px;">
              í•´ê²° ë°©ë²•:<br>
              â€¢ ì¸í„°ë„· ì—°ê²°ì„ í™•ì¸í•´ì£¼ì„¸ìš”<br>
              â€¢ í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•´ì£¼ì„¸ìš” (F5 ë˜ëŠ” Ctrl+R)<br>
              â€¢ ë¬¸ì œê°€ ê³„ì†ë˜ë©´ ìš´ì˜ì§„ì— ë¬¸ì˜í•´ì£¼ì„¸ìš”
            </div>
          </div>
        `;
      }
    }
    
    // ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
    function showSearchResults(query) {
      const resultsContainer = document.getElementById('searchResults');
      const resultsHeader = document.getElementById('searchResultsHeader');
      
      if (!query.trim()) {
        resultsContainer.innerHTML = '';
        resultsHeader.classList.remove('show');
        resultsHeader.innerHTML = '';
        return;
      }
      
      // ê¸°ìˆ ê¸°ì—…ê³¼ ë””ìì¸ê¸°ì—… ëª¨ë‘ì—ì„œ ê²€ìƒ‰
      const techFiltered = techCompanyData.filter(item => 
        item.name.toLowerCase().includes(query.toLowerCase())
      );
      
      const designFiltered = designCompanyData.filter(item => 
        item.name.toLowerCase().includes(query.toLowerCase())
      );
      
      const allFiltered = [...techFiltered, ...designFiltered];
      
      if (allFiltered.length === 0) {
        resultsContainer.innerHTML = '<div style="text-align: center; color: #a0a0a0; padding: 20px;">ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</div>';
        resultsHeader.classList.remove('show');
        resultsHeader.innerHTML = '';
        return;
      }
      
      // ê²€ìƒ‰ ê²°ê³¼ ê°œìˆ˜ í‘œì‹œ
      resultsHeader.classList.add('show');
      resultsHeader.innerHTML = `ê²€ìƒ‰ ê²°ê³¼: <span style="color: #DC2626; font-weight: 600;">${allFiltered.length}ê±´</span>`;
      
      resultsContainer.innerHTML = allFiltered.map(item => `
        <div class="search-result-item" onclick="selectPerson('${item.name.replace(/'/g, "\\'")}')">
          <div class="search-result-name">${item.name}</div>
        </div>
      `).join('');
    }
    
    // ê¸°ìˆ ê¸°ì—… ë˜ëŠ” ë””ìì¸ê¸°ì—… ì„ íƒ
    function selectPerson(name) {
      // ê¸°ìˆ ê¸°ì—…ì—ì„œ ì°¾ê¸°
      let company = techCompanyData.find(p => p.name === name);
      let isTech = true;
      
      // ê¸°ìˆ ê¸°ì—…ì—ì„œ ëª» ì°¾ìœ¼ë©´ ë””ìì¸ê¸°ì—…ì—ì„œ ì°¾ê¸°
      if (!company) {
        company = designCompanyData.find(p => p.name === name);
        isTech = false;
      }
      
      if (!company) return;
      
      // ë¼ìš´ë“œ ë°°ì • ì •ë³´ ì°¾ê¸°
      const assignments = [];
      if (assignmentData && assignmentData.assignments) {
        if (isTech) {
          // ê¸°ìˆ ê¸°ì—…ì¸ ê²½ìš°
          assignments.push(...assignmentData.assignments.filter(a => 
            a.techCompany === name || a.techCompany.includes(name) || name.includes(a.techCompany)
          ));
        } else {
          // ë””ìì¸ê¸°ì—…ì¸ ê²½ìš°
          assignments.push(...assignmentData.assignments.filter(a => 
            a.designCompany === name || a.designCompany.includes(name) || name.includes(a.designCompany)
          ));
        }
      }
      
      // ì„¸ì…˜ ì •ë³´ë¥¼ ì¹´ë“œ í˜•ì‹ìœ¼ë¡œ ìƒì„±
      let sessionInfoHTML = `<span class="seat-info-name">${company.name}</span>`;
      
      if (company.fixedSeat && company.fixedSeat !== 'ë¯¸ì •') {
        sessionInfoHTML += ` ë‹˜ì˜ ì§€ì •ì„: <span class="seat-info-location">${company.fixedSeat}</span><br>`;
      } else {
        sessionInfoHTML += '<br>';
      }
      
      const sessionCards = [];
      
      // ë¼ìš´ë“œ ë°°ì • ì •ë³´ ì¶”ê°€
      if (assignments.length > 0) {
        sessionCards.push(`
          <div class="session-card" style="border-color: #10B981;">
            <div class="session-header" style="color: #10B981;">ğŸ“… ë¼ìš´ë“œ ë°°ì •</div>
        `);
        
        for (const assignment of assignments.sort((a, b) => a.round - b.round)) {
          if (isTech) {
            sessionCards.push(`
              <div class="session-row">
                <span class="session-label">ë¼ìš´ë“œ ${assignment.round}</span>
                <span class="session-value">í…Œì´ë¸” ${assignment.table} - ${escapeHtml(assignment.designCompany)} (${assignment.score}ì )</span>
              </div>
            `);
          } else {
            sessionCards.push(`
              <div class="session-row">
                <span class="session-label">ë¼ìš´ë“œ ${assignment.round}</span>
                <span class="session-value">í…Œì´ë¸” ${assignment.table} - ${escapeHtml(assignment.techCompany)} (${assignment.score}ì )</span>
              </div>
            `);
          }
        }
        
        sessionCards.push('</div>');
      }
      
      // ê¸°ì¡´ ì„¸ì…˜ ì •ë³´ (CSV ê¸°ë°˜)
      if (company.designCompany1 && company.designCompany1 !== 'ë¯¸ì •') {
        sessionCards.push(`
          <div class="session-card">
            <div class="session-header">1ì„¸ì…˜<span class="session-time">${company.session1 || ''}</span></div>
            <div class="session-row"><span class="session-label">ë””ìì¸ì „ë¬¸ê¸°ì—…</span><span class="session-value">${company.designCompany1}</span></div>
          </div>
        `);
      }
      
      if (company.designCompany2 && company.designCompany2 !== 'ë¯¸ì •') {
        sessionCards.push(`
          <div class="session-card">
            <div class="session-header">2ì„¸ì…˜<span class="session-time">${company.session2 || ''}</span></div>
            <div class="session-row"><span class="session-label">ë””ìì¸ì „ë¬¸ê¸°ì—…</span><span class="session-value">${company.designCompany2}</span></div>
          </div>
        `);
      }
      
      if (company.designCompany3 && company.designCompany3 !== 'ë¯¸ì •') {
        sessionCards.push(`
          <div class="session-card">
            <div class="session-header">3ì„¸ì…˜<span class="session-time">${company.session3 || ''}</span></div>
            <div class="session-row"><span class="session-label">ë””ìì¸ì „ë¬¸ê¸°ì—…</span><span class="session-value">${company.designCompany3}</span></div>
          </div>
        `);
      }
      
      if (company.designCompany4 && company.designCompany4 !== 'ë¯¸ì •' && company.designCompany4.trim() !== '') {
        sessionCards.push(`
          <div class="session-card">
            <div class="session-header">3ì„¸ì…˜ (ë™ì‹œì˜ˆì•½)<span class="session-time">${company.session4 || ''}</span></div>
            <div class="session-row"><span class="session-label">ë””ìì¸ì „ë¬¸ê¸°ì—…</span><span class="session-value">${company.designCompany4}</span></div>
          </div>
        `);
      }
      
      if (sessionCards.length > 0) {
        sessionInfoHTML += sessionCards.join('');
      } else {
        sessionInfoHTML += '<br><span style="font-size: 16px; color: #a0a0a0;">ì˜ˆì •ëœ ë§Œë‚¨ì´ ì—†ìŠµë‹ˆë‹¤.</span>';
      }
      
      document.getElementById('seatInfoText').innerHTML = sessionInfoHTML;
      document.getElementById('seatInfo').classList.add('show');
      
      // ê²€ìƒ‰ì°½ ë¹„ìš°ê¸°
      document.getElementById('seatSearch').value = '';
      document.getElementById('searchResults').innerHTML = '';
      document.getElementById('searchResultsHeader').classList.remove('show');
      document.getElementById('searchResultsHeader').innerHTML = '';
    }
    
    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
    document.getElementById('seatSearch').addEventListener('input', (e) => {
      showSearchResults(e.target.value);
    });
    
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ
    loadSeatData();
  </script>
</body>
</html>
